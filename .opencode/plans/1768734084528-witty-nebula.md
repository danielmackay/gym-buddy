# Fix Client Assignment UI - Missing trainerId Parameter

## Problem
The client assignment dropdown in the workout plan detail page appears disabled because the `ClientAssignmentList` component is not fetching any clients. This is due to a missing `trainerId` parameter when calling the `useClients()` hook.

## Root Cause
**File:** `src/frontend/src/features/workout-plans/components/ClientAssignmentList.tsx:41`

```tsx
const { data: clients = [], isLoading } = useClients();  // ‚ùå Missing trainerId
```

The `useClients` hook requires a `trainerId` parameter:
- **Hook definition:** `src/frontend/src/features/trainer/hooks/useClients.ts:10`
- Has `enabled: !!trainerId` which prevents fetching when trainerId is not provided
- Without a trainerId, the query never executes, leaving `clients` as an empty array
- This results in the dropdown showing "No unassigned clients available"

## Solution
Follow the same pattern used in `ClientList.tsx` (lines 18-20):

1. Import `useUserStore` to access the current logged-in user
2. Extract the `trainerId` from `currentUser.id`
3. Pass the `trainerId` to the `useClients()` hook
4. Add proper error handling for when no user is selected

## Implementation Plan

### File: `src/frontend/src/features/workout-plans/components/ClientAssignmentList.tsx`

**Changes needed:**

1. **Line 21:** Add import for useUserStore
   ```tsx
   import { useUserStore } from "@/lib/stores/user-store";
   ```

2. **Lines 39-41:** Add currentUser and trainerId extraction, pass trainerId to useClients
   ```tsx
   const [selectedClientId, setSelectedClientId] = useState<string>("");
   
   const { currentUser } = useUserStore();
   const trainerId = currentUser?.id;
   const { data: clients = [], isLoading } = useClients(trainerId || "");
   ```

3. **Lines 82-84:** Add check for missing trainer (before the isLoading check)
   ```tsx
   if (!currentUser || !trainerId) {
     return (
       <Card>
         <CardHeader>
           <CardTitle>Assigned Clients</CardTitle>
           <CardDescription>
             Manage which clients have access to this workout plan
           </CardDescription>
         </CardHeader>
         <CardContent>
           <div className="rounded-md bg-yellow-50 p-4 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400">
             <p className="font-semibold">No trainer selected</p>
             <p className="text-sm">
               Please select a trainer from the user selection page.
             </p>
           </div>
         </CardContent>
       </Card>
     );
   }
   
   if (isLoading) {
     return <div>Loading clients...</div>;
   }
   ```

## Expected Behavior After Fix
1. When a trainer views a workout plan detail page, the `ClientAssignmentList` component will:
   - Fetch the current user from Zustand store
   - Use the trainer's ID to query for their clients via the API
   - Populate the dropdown with unassigned clients
   - Enable the assign button when a client is selected
   - Show assigned clients with functional unassign buttons

2. If no trainer is selected (edge case):
   - Show a helpful message prompting user to select a trainer
   - Prevent any API calls that would fail

## Verification Steps

### Manual Testing (Recommended)
1. Start the application: `aspire run` (from repository root)
2. Navigate to the frontend: http://localhost:3000
3. Select a trainer user from the user selection page
4. Go to the workout plans page: `/trainer/workout-plans`
5. Click on any workout plan to view its detail page
6. Scroll to the "Assigned Clients" section
7. Verify:
   - Dropdown shows list of clients (if any exist)
   - Clicking dropdown shows client names and emails
   - Selecting a client enables the assign button (UserPlus icon)
   - Clicking assign button successfully assigns the client
   - Assigned client appears in the list below with unassign button
   - Unassign button works correctly

### Create Test Data (if needed)
If no clients exist for testing:
1. Navigate to `/trainer/clients`
2. Click "New Client" button
3. Create 2-3 test clients
4. Return to workout plan detail page to test assignments

### API Verification (Optional)
Check browser DevTools Network tab:
- Should see successful `GET /api/users/clients?trainerId={id}` request
- Should see successful `POST /api/workout-plans/assign` when assigning
- Should see successful `POST /api/workout-plans/unassign` when unassigning

## Files to Modify
- `src/frontend/src/features/workout-plans/components/ClientAssignmentList.tsx` (1 file, ~10 lines changed)
