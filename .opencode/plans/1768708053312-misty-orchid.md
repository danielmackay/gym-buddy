# Plan: Seed Common Exercises into Database

## Overview
Add exercise seeding to the MigrationService to populate the database with a comprehensive list of common gym exercises during application initialization.

## Exercise Domain Understanding

### Entity Structure
- **Exercise Entity**: `src/api/src/Domain/Exercises/Exercise.cs`
  - Properties: Name (max 100 chars), Description (max 500 chars), Type, MuscleGroups
  - Factory method: `Exercise.Create(name, type, muscleGroups, description)`
  - Returns `ErrorOr<Exercise>`
  - Uses `ExerciseId` (Guid v7 for time-based ordering)

### Key Enums
- **ExerciseType**: `RepsAndWeight` (1), `TimeBased` (2)
- **MuscleGroup**: Chest, Back, Shoulders, Biceps, Triceps, Forearms, Quadriceps, Hamstrings, Glutes, Calves, Abs, Obliques

### Validation Rules
- At least 1 muscle group required
- Name is required (max 100 chars)
- Description is optional (max 500 chars)
- Type cannot be changed after creation

## Implementation Approach

### File to Modify
**`tools/MigrationService/Initializers/ApplicationDbContextInitializer.cs`**

### Changes Required

1. **Remove Legacy Hero/Team Code**
   - Remove hero/team arrays (`_superHeroNames`, `_superPowers`, etc.)
   - Remove `SeedHeroes()` and `SeedTeams()` methods
   - Update `SeedDataAsync()` to only call exercise seeding

2. **Add Exercise Data**
   - Create array of exercise definitions with: name, type, description, muscle groups
   - Include ~30 simplified exercises across all muscle groups (no equipment variations)
   - Cover both RepsAndWeight and TimeBased exercises

3. **Implement `SeedExercises()` Method**
   - Check if exercises already exist: `if (DbContext.Exercises.Any()) return;`
   - Iterate through exercise definitions
   - Call `Exercise.Create()` for each exercise
   - Handle `ErrorOr<Exercise>` result (check `.IsError`)
   - Add exercises to DbContext: `await DbContext.Exercises.AddRangeAsync(exercises)`
   - Save changes: `await DbContext.SaveChangesAsync()`

4. **Update Transaction in `SeedDataAsync()`**
   ```csharp
   await SeedAdminUser();
   await SeedExercises();
   ```

### Exercise List (Simplified - No Equipment Variations)

#### Chest (RepsAndWeight)
- Bench Press
- Flyes
- Push-ups

#### Back (RepsAndWeight)
- Rows
- Lat Pulldown
- Pull-ups
- Deadlift

#### Shoulders (RepsAndWeight)
- Overhead Press
- Lateral Raise
- Front Raise
- Rear Delt Flye
- Shrugs

#### Arms - Biceps (RepsAndWeight)
- Bicep Curl
- Hammer Curl

#### Arms - Triceps (RepsAndWeight)
- Tricep Extension
- Tricep Dip
- Tricep Pushdown

#### Legs - Quadriceps (RepsAndWeight)
- Squat
- Leg Press
- Lunge
- Leg Extension

#### Legs - Hamstrings (RepsAndWeight)
- Leg Curl
- Romanian Deadlift

#### Glutes (RepsAndWeight)
- Hip Thrust
- Glute Bridge

#### Calves (RepsAndWeight)
- Calf Raise

#### Core - Abs (TimeBased & RepsAndWeight)
- Plank (TimeBased)
- Side Plank (TimeBased)
- Crunch (RepsAndWeight)
- Leg Raise (RepsAndWeight)
- Mountain Climbers (RepsAndWeight)

#### Core - Obliques (RepsAndWeight)
- Russian Twist
- Side Bend

**Total: ~30 exercises** (simplified, equipment-agnostic)

### Code Structure Pattern

```csharp
private readonly (string Name, ExerciseType Type, string Description, MuscleGroup[] MuscleGroups)[] _exercises =
[
    ("Bench Press", ExerciseType.RepsAndWeight, 
     "Horizontal pressing exercise for chest development", 
     [MuscleGroup.Chest, MuscleGroup.Triceps, MuscleGroup.Shoulders]),
    
    ("Pull-ups", ExerciseType.RepsAndWeight,
     "Upper body pulling exercise targeting the back",
     [MuscleGroup.Back, MuscleGroup.Biceps]),
    
    ("Plank", ExerciseType.TimeBased,
     "Isometric core exercise",
     [MuscleGroup.Abs]),
    
    // ... more exercises (simplified, no equipment variations)
];

private async Task SeedExercises()
{
    if (DbContext.Exercises.Any())
        return;

    var exercises = new List<Exercise>();
    
    foreach (var (name, type, description, muscleGroups) in _exercises)
    {
        var result = Exercise.Create(name, type, muscleGroups, description);
        
        if (result.IsError)
            continue; // Skip invalid exercises
        
        exercises.Add(result.Value);
    }
    
    await DbContext.Exercises.AddRangeAsync(exercises);
    await DbContext.SaveChangesAsync();
}
```

## Files to Modify

1. **`tools/MigrationService/Initializers/ApplicationDbContextInitializer.cs`**
   - Remove Hero/Team seeding code
   - Add exercise definitions array
   - Implement `SeedExercises()` method
   - Update `SeedDataAsync()` to call exercise seeding

## Verification

### 1. Run the Application
```bash
aspire run
```

### 2. Check Database
- Open Aspire Dashboard
- Navigate to SQL Server resources
- Query the Exercises table: `SELECT COUNT(*) FROM Exercises`
- Should see ~30 exercises

### 3. Test API
- Open Swagger UI: https://localhost:7255/scalar/v1
- Call `GET /api/exercises` endpoint
- Verify exercises are returned with proper:
  - Names and descriptions
  - Exercise types (RepsAndWeight, TimeBased)
  - Muscle groups (multiple per exercise)

### 4. Re-run Safety
- Delete the database and re-run `aspire run`
- Verify exercises are seeded again
- Verify no duplicate exercises are created on subsequent runs

## Notes

- Following existing pattern from `SeedAdminUser()` method
- Using ErrorOr pattern for safe exercise creation
- Idempotent seeding (checks if exercises exist first)
- Runs within the existing transaction in `SeedDataAsync()`
- Legacy Hero/Team code will be removed (no longer needed for gym app)
