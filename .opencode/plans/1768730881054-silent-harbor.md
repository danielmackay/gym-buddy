# Add Typeahead Search to Exercise Dropdown

## Overview
Replace the current basic Select dropdown in the "Add Exercise" modal with a Combobox component that supports typeahead search. This will allow users to quickly find exercises by typing instead of scrolling through a long list.

## Current Implementation
- **File**: `src/frontend/src/features/workout-plans/components/AddExerciseModal.tsx` (lines 134-155)
- **Current Component**: Basic `Select` from Shadcn/ui (Radix UI)
- **Limitation**: No search/filter capability - users must scroll to find exercises

## Implementation Plan

### 1. Install Required Shadcn Components
**Commands** (run from `src/frontend/`):
```bash
npx shadcn@latest add command
npx shadcn@latest add popover
npx shadcn@latest add combobox
```

**What gets installed**:
- `cmdk` package (Command menu library)
- `@radix-ui/react-popover` package
- Components: `src/frontend/src/components/ui/command.tsx`
- Components: `src/frontend/src/components/ui/popover.tsx`
- Components: `src/frontend/src/components/ui/combobox.tsx`

### 2. Update AddExerciseModal Component
**File**: `src/frontend/src/features/workout-plans/components/AddExerciseModal.tsx`

**Changes**:
1. **Import new components** (replace Select imports):
   ```typescript
   // Remove:
   import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
   
   // Add:
   import { Combobox } from "@/components/ui/combobox";
   // OR use Command + Popover directly if Combobox doesn't exist
   import { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem } from "@/components/ui/command";
   import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
   import { Check, ChevronsUpDown } from "lucide-react";
   ```

2. **Update state** (line 45):
   ```typescript
   // Add state for combobox open/close
   const [open, setOpen] = useState(false);
   ```

3. **Replace Select with Combobox** (lines 134-155):
   - See section 3 below for the full implementation with grouped exercises

4. **Add cn utility import** (if not already present):
   ```typescript
   import { cn } from "@/lib/utils";
   ```

5. **Keep weight unit Select unchanged** (lines 208-225) - this dropdown doesn't need search

### 3. Group Exercises by Type
Exercises should be grouped by type for better UX:
```typescript
<Command>
  <CommandInput placeholder="Search exercises..." />
  <CommandEmpty>No exercise found.</CommandEmpty>
  <CommandGroup heading="Reps & Weight">
    {exercises?.filter(ex => ex.type === ExerciseType.RepsAndWeight).map((exercise) => (
      <CommandItem
        key={exercise.id}
        value={exercise.name}
        onSelect={() => {
          setSelectedExerciseId(exercise.id);
          setValue("exerciseId", exercise.id);
          setOpen(false);
        }}
      >
        <Check
          className={cn(
            "mr-2 h-4 w-4",
            selectedExerciseId === exercise.id ? "opacity-100" : "opacity-0"
          )}
        />
        {exercise.name}
      </CommandItem>
    ))}
  </CommandGroup>
  <CommandGroup heading="Time-Based">
    {exercises?.filter(ex => ex.type === ExerciseType.TimeBased).map((exercise) => (
      <CommandItem
        key={exercise.id}
        value={exercise.name}
        onSelect={() => {
          setSelectedExerciseId(exercise.id);
          setValue("exerciseId", exercise.id);
          setOpen(false);
        }}
      >
        <Check
          className={cn(
            "mr-2 h-4 w-4",
            selectedExerciseId === exercise.id ? "opacity-100" : "opacity-0"
          )}
        />
        {exercise.name}
      </CommandItem>
    ))}
  </CommandGroup>
</Command>
```

## Key Files to Modify
- ‚úèÔ∏è `src/frontend/src/features/workout-plans/components/AddExerciseModal.tsx` - Replace Select with Combobox

## Key Files Added
- ‚ûï `src/frontend/src/components/ui/command.tsx` - Command component
- ‚ûï `src/frontend/src/components/ui/popover.tsx` - Popover component
- ‚ûï `src/frontend/src/components/ui/combobox.tsx` - Combobox component (if available)
- üì¶ `src/frontend/package.json` - Add cmdk and @radix-ui/react-popover

## Verification Steps
1. **Start the app**: `aspire run` from repository root
2. **Navigate to trainer workout plans**: 
   - Select "Alice (Trainer)" from user dropdown
   - Click "Workout Plans" in navigation
   - Click into an existing workout plan or create a new one
3. **Open "Add Exercise" modal**: Click "Add Exercise" button
4. **Test typeahead search**:
   - Click the exercise dropdown
   - Type "bench" - should filter to show only "Bench Press" (if it exists)
   - Type "squat" - should filter to show squats
   - Arrow keys should navigate filtered results
   - Enter key should select highlighted exercise
   - Escape should close the dropdown
5. **Test form submission**: Select an exercise, fill in sets/reps/weight, click "Add Exercise"
6. **Verify exercise is added** to the workout plan list

## Design Notes
- **Accessibility**: Command component handles keyboard navigation (‚Üë‚Üì arrows, Enter, Escape)
- **Mobile-friendly**: Popover adapts to screen size (may need to adjust width for mobile)
- **Consistent styling**: Uses existing Button and Popover styles from Shadcn/ui
- **Search algorithm**: `cmdk` uses fuzzy search by default (matches partial strings)
- **Performance**: Filter happens client-side (acceptable for <1000 exercises)
